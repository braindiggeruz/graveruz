---
import BaseLayout from '../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';

// Get all posts sorted by date
const posts = await getCollection('posts');
const sortedPosts = posts.sort((a, b) => 
  new Date(b.data.publishedAt).getTime() - new Date(a.data.publishedAt).getTime()
);

const title = "Блог Graver.uz — Корпоративные подарки с гравировкой | Ташкент";
const description = "Статьи о корпоративных подарках, брендировании и лазерной гравировке для B2B. Гайды, советы по закупкам, идеи подарочных наборов.";
---

<BaseLayout title={title} description={description}>
  <section class="hero">
    <div class="container">
      <h1>Блог <span>Graver.uz</span></h1>
      <p>Гайды, кейсы и советы по корпоративным подаркам с гравировкой для бизнеса в Узбекистане</p>
      <a href="https://gifting-hub-16.emergent.host/#contact" class="cta-primary" target="_blank">
        Получить макет и расчёт →
      </a>
    </div>
  </section>
  
  <section class="container" style="padding: 64px 20px;">
    <h2 style="font-size: 2rem; color: #fff; margin-bottom: 32px;">Все статьи</h2>
    
    <div class="posts-grid">
      {sortedPosts.map(post => (
        <article class="post-card">
          <div class="post-card-content">
            <span class="category">{post.data.category}</span>
            <h3>
              <a href={`/${post.slug}`} style="color: inherit; text-decoration: none;">
                {post.data.title}
              </a>
            </h3>
            <p>{post.data.excerpt}</p>
            <a href={`/${post.slug}`} class="read-more">Читать статью →</a>
          </div>
        </article>
      ))}
    </div>
    
    {sortedPosts.length === 0 && (
      <p style="color: #888; text-align: center; padding: 48px;">
        Статьи скоро появятся. Подпишитесь на <a href="/rss.xml">RSS</a>, чтобы не пропустить.
      </p>
    )}
  </section>
</BaseLayout>
